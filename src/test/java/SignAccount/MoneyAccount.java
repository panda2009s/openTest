package SignAccount;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import java.util.Set;

public class MoneyAccount extends WebDriverSettings{

    public void createMoneyAccounts (WebDriver driver, WebDriverWait wait, OpportunityType opportunityType, NameAccounts nameAccounts) throws InterruptedException {
        driver = driver;
        wait = wait;
        Thread.sleep(10000);
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='grouptab_7']")));
        driver.findElement(By.xpath("//*[@id='grouptab_7']")).click();
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='moduleTab_7_MoneyAccount']")));
        driver.findElement(By.xpath("//*[@id='moduleTab_7_MoneyAccount']")).click();
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='ul_shortcuts']/li[1]/a/span")));
        driver.findElement(By.xpath("//*[@id='ul_shortcuts']/li[1]/a/span")).click();

        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='full_name']")));
        String originalWindow5 = driver.getWindowHandle();
        final Set<String> oldWindowsSet5 = driver.getWindowHandles();
                driver.findElement(By.xpath("//*[@id='btn_kladdress_jur_ur_id_name']")).click();
        String newWindow5 = (new WebDriverWait(driver, 10))
                .until(new ExpectedCondition<String>() {
                           public String apply(WebDriver driver) {
                               Set<String> newWindowsSet = driver.getWindowHandles();
                               newWindowsSet.removeAll(oldWindowsSet5);
                               return newWindowsSet.size() > 0 ?
                                       newWindowsSet.iterator().next() : null;
                           }
                       }
                );
        driver.switchTo().window(newWindow5);
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='region']")));
        driver.findElement(By.xpath("//*[@id='region']")).sendKeys("Москва");
        driver.findElement(By.xpath("//*[@id='city']")).sendKeys("Москва");
        driver.findElement(By.xpath("//*[@id='EditView']/table[1]/tbody/tr/td[1]/input[15]")).click();
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='Ok']")));
        driver.findElement(By.xpath("//*[@id='Ok']")).click();
        Thread.sleep(5000);
        driver.findElement(By.xpath("//*[@id='kladdressSave']")).click();
        driver.switchTo().window(originalWindow5);


        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='full_name']")));
        String originalWindow3 = driver.getWindowHandle();
        final Set<String> oldWindowsSet3 = driver.getWindowHandles();
        driver.findElement(By.xpath("//*[@id='btn_account_name']")).click();
        String newWindow3 = (new WebDriverWait(driver, 10))
                .until(new ExpectedCondition<String>() {
                           public String apply(WebDriver driver) {
                               Set<String> newWindowsSet = driver.getWindowHandles();
                               newWindowsSet.removeAll(oldWindowsSet3);
                               return newWindowsSet.size() > 0 ?
                                       newWindowsSet.iterator().next() : null;
                           }
                       }
                );
        driver.switchTo().window(newWindow3);
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='name_advanced']")));
        WebElement selectElem5 = driver.findElement(By.xpath("//*[@name='service_office_c_advanced[]']"));
        Select select5 = new Select(selectElem5);
        select5.selectByValue("2ef382e7-41da-1372-16f8-57ceb4aead9c"); //Головной
        driver.findElement(By.xpath("//*[@id='popup_query_form']/table/tbody/tr[2]/td[1]/input[13]")).click();
        driver.findElement(By.xpath("//tr/td/a")).click();
        driver.switchTo().window(originalWindow3);
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='ownership']")));
        WebElement selectElem = driver.findElement(By.xpath("//*[@id='ownership']"));
        Select select = new Select(selectElem);
        select.selectByValue("65");
        driver.findElement(By.xpath("//*[@id='inn']")).sendKeys("321321321321");
        driver.findElement(By.xpath("//*[@id='ogrn']")).clear();
        driver.findElement(By.xpath("//*[@id='ogrn']")).sendKeys("321321321");
        WebElement selectElem2 = driver.findElement(By.xpath("//*[@id='document_pack']"));
        Select select2 = new Select(selectElem2);
        select2.selectByValue("minimum");
        driver.findElement(By.xpath("//*[@id='full_name']")).sendKeys(nameAccounts.toString());
        driver.findElement(By.xpath("//*[@id='kpp']")).sendKeys("213213213");
        driver.findElement(By.xpath("//*[@id='okpo']")).sendKeys("42421421412");
        driver.findElement(By.xpath("//*[@id='okved2']")).sendKeys("32132131");
        driver.findElement(By.xpath("//*[@id='okved']")).sendKeys("32132131");
        driver.findElement(By.xpath("//*[@id='contact1_extra_phone']")).sendKeys("3132132132");
        WebElement selectElem3 = driver.findElement(By.xpath("//*[@id='service_office']"));
        Select select3 = new Select(selectElem3);
        select3.selectByValue("e0a9d36f-d3d1-3953-4279-58a1729d74e3");
        WebElement selectElem4 = driver.findElement(By.xpath("//*[@id='stock_c']"));
        Select select4 = new Select(selectElem4);
        select4.selectByValue("absence_of_shares");
        WebElement selectElem6 = driver.findElement(By.xpath("//*[@id='opportunity_type']"));
        Select select6 = new Select(selectElem6);
        select6.selectByValue(opportunityType.toString()); //тип счета
        Thread.sleep(2000);
        driver.findElement(By.xpath("//*[@id='EditView']/table[1]/tbody/tr/td[1]/input[17]")).click();
    }
}
