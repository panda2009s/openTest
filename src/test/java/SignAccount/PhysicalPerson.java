package SignAccount;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import java.util.Set;

public class PhysicalPerson {

    public void createPhysicalPerson(WebDriver driver, WebDriverWait wait, PhysicalPersonSignType physicalPersonSignType, PhysicalPersonFirstName physicalPersonFirstName, PhysicalPersonPatronName physicalPersonPatronName, PhysicalPersonLastName physicalPersonLastName) throws InterruptedException {
        driver = driver;
        wait = wait;
        Thread.sleep(20000);
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@name='moneyaccount_contacts_msb_create_button']")));
        Thread.sleep(10000);
        driver.findElement(By.xpath("//*[@name='moneyaccount_contacts_msb_create_button']")).click();
        Thread.sleep(2000);
        String originalWindow = driver.getWindowHandle();
        final Set<String> oldWindowsSet = driver.getWindowHandles();
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='btn_kladdress_fact_fl_id_name']")));
        driver.findElement(By.xpath("//*[@id='btn_kladdress_fact_fl_id_name']")).click();
        Thread.sleep(2000);
        String newWindow = (new WebDriverWait(driver, 30))
                .until(new ExpectedCondition<String>() {
                           public String apply(WebDriver driver) {
                               Set<String> newWindowsSet = driver.getWindowHandles();
                               newWindowsSet.removeAll(oldWindowsSet);
                               return newWindowsSet.size() > 0 ?
                                       newWindowsSet.iterator().next() : null;
                           }
                       }
                );
        driver.switchTo().window(newWindow);
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='region']")));
        driver.findElement(By.xpath("//*[@id='region']")).sendKeys("Москва");
        driver.findElement(By.xpath("//*[@id='city']")).sendKeys("Москва");
        driver.findElement(By.xpath("//*[@id='EditView']/table[1]/tbody/tr/td[1]/input[15]")).click();
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='Ok']")));
        driver.findElement(By.xpath("//*[@id='Ok']")).click();
        Thread.sleep(5000);
        driver.findElement(By.xpath("//*[@id='kladdressSave']")).click();
        driver.switchTo().window(originalWindow);
        wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//*[@id='resident']")));
        WebElement residentElem = driver.findElement(By.xpath("//*[@id='resident']"));
        Select residentSelect = new Select(residentElem);
        residentSelect.selectByValue("rf");


        // единоличная подпись
        WebElement signatureElem = driver.findElement(By.xpath("//*[@id='signature_type']"));
        Select signatureSelect = new Select(signatureElem);
        signatureSelect.selectByValue(physicalPersonSignType.toString()); // тип подписи



        driver.findElement(By.xpath("//*[@id='first_name']")).sendKeys(physicalPersonFirstName.toString()); //имя физ.лица
        driver.findElement(By.xpath("//*[@id='patron_name']")).sendKeys(physicalPersonPatronName.toString()); //отчество физ.лица
        driver.findElement(By.xpath("//*[@id='last_name']")).sendKeys(physicalPersonLastName.toString()); //фамилия физ.лица

        driver.findElement(By.xpath("//*[@id='birthdate']")).sendKeys("12.03.1991");
        driver.findElement(By.xpath("//*[@id='passport_serial']")).sendKeys("4611");
        driver.findElement(By.xpath("//*[@id='passport_number']")).sendKeys("367894");
        WebElement birth_regionElem = driver.findElement(By.xpath("//*[@id='birth_region']"));
        Select birth_regionSelect = new Select(birth_regionElem);
        birth_regionSelect.selectByValue("11000000000");
        driver.findElement(By.xpath("//*[@id='birth_place']")).sendKeys("Москва");
        driver.findElement(By.xpath("//*[@id='doc_type_other']")).sendKeys("4611367894");
        driver.findElement(By.xpath("//*[@id='passport_date_issued']")).sendKeys("12.03.2000");
        driver.findElement(By.xpath("//*[@id='passport_where_issued']")).sendKeys("Москва");
     //   String originalWindow2 = driver.getWindowHandle();
       // final Set<String> oldWindowsSet2 = driver.getWindowHandles();
        Thread.sleep(5000);
        driver.findElement(By.xpath("//*[@id='Contacts_msb_subpanel_save_button']")).click();
    }
}
